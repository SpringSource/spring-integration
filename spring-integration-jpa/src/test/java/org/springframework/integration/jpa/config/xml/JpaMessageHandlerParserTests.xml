<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:jdbc="http://www.springframework.org/schema/jdbc"
	xmlns:int="http://www.springframework.org/schema/integration"
	xmlns:int-jpa="http://www.springframework.org/schema/integration/jpa"
	xsi:schemaLocation="http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd
		http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/integration/jpa http://www.springframework.org/schema/integration/jpa/spring-integration-jpa-2.2.xsd">

<int:channel id="target"/>

    <jdbc:embedded-database id="dataSource" type="H2"/>
    
    <bean id="lc"
        class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="dataSource" />
    </bean>
    
    <bean id="entity-manager"
        class="org.springframework.orm.jpa.support.SharedEntityManagerBean">
        <property name="entityManagerFactory" ref="lc" />
    </bean>

    <int-jpa:outbound-channel-adapter id="jpaOutboundChannelAdapter" 
                                      entity-manager="entity-manager"
                                      
                                      auto-startup="true"
                                      entity-class="org.springframework.integration.jpa.test.entity.Student"
                                      query="from Student"
                                      native-query="false"
                                      persist-mode="PERSIST"
                                      order="1"                            
                                      channel="target">                 
        <int-jpa:parameter  name="firstName"   value="kenny"  type="java.lang.String"/>
        <int-jpa:parameter  name="firstaName"  value="cartman"/>     
        <int-jpa:parameter  name="updatedDateTime" expression="new java.util.Date()"/>                   
    </int-jpa:outbound-channel-adapter>


<!--     <int-jpa:inbound-channel-adapter id="inbound-channel-adapter"
                                     entity-manager="entity-manager"
                                     entity-manager-factory="entity-manager-factory"
                                     jpa-operations="custom"
                                     auto-startup="true"
                                     entity-class="org.springframework.integration.jpa.test.entity.Student"
                                     query="from Student"
                                     native-query="true"
                                     named-query="myNamedQery"                                     
                                     
                                     delete-after-poll="true"
                                     delete-per-row="true"                                     
                                     
                                     channel=""
                                     send-timeout ="">
         <int:poller/>
         
     </int-jpa:inbound-channel-adapter>   -->
             
<!-- 	<int-jpa:outbound-channel-adapter id="jpaOutboundChannelAdapter" 
                                      entity-manager="entity-manager"
                                      entity-manager-factory="entity-manager-factory"
                                      jpa-operations="custom"
                                      auto-startup="true"
                                      entity-class="org.springframework.integration.jpa.test.entity.Student"
                                      query="from Student"
                                      native-query="true"
                                      named-query="myNamedQery"

                                      persist-mode="MERGE"
                                      parameter-source-factory=""
                                      use-payload-as-parameter-source="false"
                                      order="1"
                                                                         
	                                  channel="target">
	                                  
	    <int-jpa:parameter  name="firstName"   value="kenny"  type="java.lang.String"/>
        <int-jpa:parameter  name="firstaName"  value="cartman"/>     
        <int-jpa:parameter  name="updatedDateTime" expression="new java.util.Date()"/>           
                
    </int-jpa:outbound-channel-adapter> -->
                           	
<!--     <int-jpa:outbound-gateway id="outbound-gateway"
                              entity-manager="entity-manager"
                              entity-manager-factory="entity-manager-factory"
                              jpa-operations="custom"
                              auto-startup="true"
                              entity-class="org.springframework.integration.jpa.test.entity.Student"
                              query=""
                              native-query="true"
                              named-query="myNamedQery"
                              
                              persist-mode="MERGE"
                              parameter-source-factory=""
                              use-payload-as-parameter-source="false"
                              order="1"
                              
                              delete-after-poll="true"
                              delete-per-row="true"
                              
                              gateway-type="UPDATING"
                              max-rows="-1"
                              request-channel="outbound-gateway-channel"
                              reply-channel=""
                              reply-timeout="">
                <int:poller></int:poller>
                <int-jpa:parameter expression="payload"/>             
    </int-jpa:outbound-gateway>                                
                                    -->  
</beans>
