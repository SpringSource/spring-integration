<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="https://www.springframework.org/schema/integration"
	xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance"
	xmlns:beans="https://www.springframework.org/schema/beans"
	xmlns:int-jmx="https://www.springframework.org/schema/integration/jmx"
	xmlns:context="https://www.springframework.org/schema/context"
	xsi:schemaLocation="https://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
		https://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd
		https://www.springframework.org/schema/integration/jmx https://www.springframework.org/schema/integration/jmx/spring-integration-jmx.xsd
		https://www.springframework.org/schema/integration https://www.springframework.org/schema/integration/spring-integration.xsd">

	<context:mbean-server/>

	<int-jmx:mbean-export default-domain="transformers" />

	<channel id="input"/>
	
	<recipient-list-router input-channel="input"> <!-- INT-3565 ClassCastException with DEBUG -->
		<recipient channel="input1" selector-expression="true" />
	</recipient-list-router>

	<channel id="output">
		<queue capacity="50"/>
	</channel>

	<transformer input-channel="input1" ref="testBean" method="upperCase" output-channel="output">
		<request-handler-advice-chain>
			<beans:bean class="org.springframework.integration.monitor.TransformerContextTests$FooAdvice" />
		</request-handler-advice-chain>
	</transformer>

	<beans:bean id="testBean" class="org.springframework.integration.monitor.TransformerContextTests$BazService"/>

	<transformer input-channel="direct" output-channel="output">
		<beans:bean class="org.springframework.integration.monitor.TransformerContextTests$Bar"/>
	</transformer>

	<transformer input-channel="directRef" output-channel="output" ref="trans" method="handleMessage">
		<request-handler-advice-chain>
			<beans:bean class="org.springframework.integration.monitor.TransformerContextTests$FooAdvice" />
		</request-handler-advice-chain>
	</transformer>
	
	<beans:bean id="trans" class="org.springframework.integration.monitor.TransformerContextTests$Bar"/>

	<service-activator input-channel="service" method="qux">
		<beans:bean class="org.springframework.integration.monitor.TransformerContextTests$BazService" />
		<request-handler-advice-chain>
			<beans:bean class="org.springframework.integration.monitor.TransformerContextTests$FooAdvice" />
		</request-handler-advice-chain>
	</service-activator>

</beans:beans>
